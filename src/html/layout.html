<!DOCTYPE html>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>{{title}}</title>
{{#description}}<meta name="description" content="{{description}}">{{/description}}
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="{{{assetUrl}}}index.css">



<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
  $(function() {
    $('form').on('click', 'button', function(e) {
      var $form = $(this).closest('form');

      $.ajax({
        url: $form.attr('action'),
        type: 'post',
        dataType: 'json',
        data: $form.serialize(),
        success: function(data) {
          console.log(data)

          if (($form.is('#signin')) && data.id) {
            location.href = '/';
          }
        },
        error: function(data) {
          console.log('Got error');
        }
      });

      e.preventDefault();
    });
  });
</script>



{{^activeUser}}
<form id="signin" action="/api/signin" method="post">
  <input name="email" type="text">
  <input name="password" type="password">
  <button type="submit">Sign in</button>
</form>

<form id="signup" action="/api/signup" method="post">
  <input name="email" type="text">
  <input name="password" type="password">
  <button type="submit">sign up</button>
</form>

<form id="check" action="/api/available-email" method="post">
  <input name="email" type="text">
  <button type="submit">check availability</button>
</form>
{{/activeUser}}

{{#activeUser}}
<hr>
<a href="/signout">Signout</a>
{{/activeUser}}

{{#index}}
  √ Intro texts
{{/index}}

{{#inEditMode}}
  √ Design settings
  √ Edit posts
{{/inEditMode}}

{{#dump}}
{{{dump}}}
{{/dump}}

{{#serverError}}
<h1>Damn it. 505 server error</h1>
{{/serverError}}

{{#notFound}}
<h1>Woops. 404 not found</h1>
{{/notFound}}

{{> symbols}}

<script>
  var DATA = {}

  // Trigger svg redraw (safari issue)
  document.addEventListener('DOMContentLoaded', function(){
    var elms = document.getElementsByTagName('use');
    Array.prototype.forEach.call(elms, function(el, i){
      var href = el.getAttribute('xlink:href');
      el.setAttribute('xlink:href', href);
    });
  });

  {{#analyticsCode}}
  // Google analytics
  /* (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', '{{{analyticsCode}}}', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview'); */
  {{/analyticsCode}}
</script>