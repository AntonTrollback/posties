<div id="closeOverlays" ng-show="settingsService.isOpen" ng-click="settingsService.submitUpdateSettingsAndClose(userSettings)"></div>

<div class="popover is-customize updateSettings" id="modalUpdateSettings" ng-show="settingsService.isOpen" ng-cloak>
  <div class="popover-arrow"><svg role="presentation"><use xlink:href="#popover-arrow"></use></svg></div>
  <form class="panels" id="updateSettings" method="put" name="formSettings" ng-submit="settingsService.submitUpdateSettings(userSettings)" novalidate>
    <div class="panel is-active" id="panelPrimarySettings">

      <!-- Links to font panels -->

      <a class="panel-item" data-go-to-panel="panelTextFont" analytics-on="click" analytics-event="Change" analytics-category="Website design settings" analytics-label="Text font">
        <span class="panel-item-text">Text font</span>
        <div class="panel-item-preview">
          <span class="panel-item-text is-larger" ng-model="userSettings.typefaceparagraph" style="font-family: '[[userSettings.typefaceparagraph]]'">
            [[userSettings.typefaceparagraph]]
          </span>
        </div>
        <div class="panel-item-icon"><svg role="presentation"><use xlink:href="#arrow-right"></use></svg></div>
      </a>

      <a class="panel-item" data-go-to-panel="panelHeadlineFont" analytics-on="click" analytics-event="Change" analytics-category="Website design settings" analytics-label="Headline font">
        <span class="panel-item-text">Headline font</span>
        <div class="panel-item-preview">
          <span class="panel-item-text is-larger" ng-model="userSettings.typefaceheadline" style="font-family: '[[userSettings.typefaceheadline]]'">
            [[userSettings.typefaceheadline]]
          </span>
        </div>
        <div class="panel-item-icon"><svg role="presentation"><use xlink:href="#arrow-right"></use></svg></div>
      </a>

      <!-- Inline show boxes -->

      <label class="panel-item toggle-parent" for="showBoxes" analytics-on="click" analytics-event="Change" analytics-category="Website design settings" analytics-label="Toggle boxes">
        <span class="panel-item-text">Use boxes</span>
        <span class="panel-item-preview">
          <span class="panel-item-toggle toggle">
            <input id="showBoxes" type="checkbox" ng-checked="userSettings.showboxes" ng-model="userSettings.showboxes">
            <span class="toggle-handle"></span>
          </span>
        </span>
      </label>

      <!-- Links to color panels -->

      <a class="panel-item" data-go-to-panel="panelBoxColor" ng-class="userSettings.showboxes ? '' : 'is-disabled'" analytics-on="click" analytics-event="Change" analytics-category="Website design settings" analytics-label="Box color">
        <span class="panel-item-text">Box color</span>
        <span class="panel-item-preview" style="background-color: [[userSettings.postbackgroundcolor]]"></span>
        <div class="panel-item-icon is-transparent"><svg role="presentation"><use xlink:href="#arrow-right"></use></svg></div>
      </a>

      <a class="panel-item" data-go-to-panel="panelTextColor" analytics-on="click" analytics-event="Change" analytics-category="Website design settings" analytics-label="Text color">
        <span class="panel-item-text">Text color</span>
        <span class="panel-item-preview" style="background-color: [[userSettings.posttextcolor]]"></span>
        <div class="panel-item-icon is-transparent"><svg role="presentation"><use xlink:href="#arrow-right"></use></svg></div>
      </a>

      <a class="panel-item" data-go-to-panel="panelBackground" analytics-on="click" analytics-event="Change" analytics-category="Website design settings" analytics-label="Background color">
        <span class="panel-item-text">Background</span>
        <span class="panel-item-preview" style="background-color: [[userSettings.pagebackgroundcolor]]"></span>
        <div class="panel-item-icon is-transparent"><svg role="presentation"><use xlink:href="#arrow-right"></use></svg></div>
      </a>

      <!-- Reset and randomize -->

      <div class="popover-body">
        <button class="button" ng-click="userSettings = settingsService.getDefaultSettings()"><span analytics-on="click" analytics-event="Reset" analytics-category="Website design settings">Reset</span></button>
        <span style="margin-left: 0.5em;">or <a ng-click="userSettings = settingsService.getRandomSettings()"><span analytics-on="click" analytics-event="Randomize" analytics-category="Website design settings">randomize</span></a>!</span>
        <button id="saveUserSettings" class="button" style="display: none;">Save</button>
      </div>
    </div>


    <div class="panel" id="panelTextFont">
      <div class="popover-header">
        <button class="button" ng-click="settingsService.submitUpdateSettings(userSettings)" data-go-to-panel="panelPrimarySettings">
          <svg role="presentation"><use xlink:href="#arrow-left"></use></svg> Settings
        </button>
      </div>

      <div class="popover-scroll">
        {% for font in fonts %}
          <a class="panel-item" style="font-family: '{{font}}'" ng-click="userSettings.typefaceparagraph = '{{font}}'">
            <span class="panel-item-text is-larger">{{font}}</span>
            <div class="panel-item-icon is-transparent is-static" ng-show="userSettings.typefaceparagraph === '{{font}}'"><svg role="presentation"><use xlink:href="#check"></use></svg></div>
          </a>
        {% endfor %}
      </div>
    </div>

    <div class="panel" id="panelHeadlineFont">
      <div class="popover-header">
        <button class="button" ng-click="settingsService.submitUpdateSettings(userSettings)" data-go-to-panel="panelPrimarySettings">
          <svg role="presentation"><use xlink:href="#arrow-left"></use></svg> Settings
        </button>
      </div>

      <div class="popover-scroll">
        {% for font in fonts %}
          <a class="panel-item" style="font-family: '{{font}}'" ng-click="userSettings.typefaceheadline = '{{font}}'">
            <span class="panel-item-text is-larger">{{font}}</span>
            <div class="panel-item-icon is-transparent is-static" ng-show="userSettings.typefaceheadline === '{{font}}'"><svg role="presentation"><use xlink:href="#check"></use></svg></div>
          </a>
        {% endfor %}
      </div>
    </div>

    <div class="panel" id="panelBoxColor">
      <div class="popover-header">
        <button class="button" ng-click="settingsService.submitUpdateSettings(userSettings)" data-go-to-panel="panelPrimarySettings">
          <svg role="presentation"><use xlink:href="#arrow-left"></use></svg> Settings
        </button>
      </div>
      <div class="popover-body">
        <div class="palette">
          <button class="palette-item" ng-repeat="color in settingsService.getBackgroundPalette()" ng-style="{ 'background': color }" ng-click="userSettings.postbackgroundcolor = color"></button>
        </div>
        <input class="minicolors" maxlength="7" type="text" ng-model="userSettings.postbackgroundcolor">
        <input id="resultBoxColor" class="minicolors-result" type="hidden">
      </div>
    </div>

    <div class="panel" id="panelTextColor">
      <div class="popover-header">
        <button class="button" ng-click="settingsService.submitUpdateSettings(userSettings)" data-go-to-panel="panelPrimarySettings">
          <svg role="presentation"><use xlink:href="#arrow-left"></use></svg> Settings
        </button>
      </div>
      <div class="popover-body">
        <div class="palette">
          <button class="palette-item" ng-repeat="color in settingsService.getFontPalette()" ng-style="{ 'background': color }" ng-click="userSettings.posttextcolor = color"></button>
        </div>
        <input class="minicolors" maxlength="7" type="text" ng-model="userSettings.posttextcolor">
        <input id="resultTextColor" class="minicolors-result" type="hidden">
      </div>
    </div>

    <div class="panel" id="panelBackground">
      <div class="popover-header">
        <button class="button" ng-click="settingsService.submitUpdateSettings(userSettings)" data-go-to-panel="panelPrimarySettings">
          <svg role="presentation"><use xlink:href="#arrow-left"></use></svg> Settings
        </button>
      </div>
      <div class="popover-body">
        <div class="palette">
          <button class="palette-item" ng-repeat="color in settingsService.getBackgroundPalette()" ng-style="{ 'background': color }" ng-click="userSettings.pagebackgroundcolor = color"></button>
        </div>
        <input class="minicolors" maxlength="7" type="text" ng-model="userSettings.pagebackgroundcolor">
        <input id="resultBackground" class="minicolors-result" type="hidden">
      </div>
    </div>

  </form>
</div>
